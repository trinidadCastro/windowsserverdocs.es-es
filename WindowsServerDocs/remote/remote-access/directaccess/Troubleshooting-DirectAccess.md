---
title: Solución de problemas de DirectAccess
description: En este tema se proporciona información sobre cómo solucionar problemas de implementaciones de DirectAccess en Windows Server 2016.
manager: brianlic
ms.topic: article
ms.assetid: 61040e19-5960-4eb0-b612-d710627988f7
ms.author: lizross
author: eross-msft
ms.date: 08/07/2020
ms.openlocfilehash: 5a576adbe8af0370316cf671bd8e814a8bffbc7b
ms.sourcegitcommit: 40905b1f9d68f1b7d821e05cab2d35e9b425e38d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/06/2021
ms.locfileid: "97949861"
---
# <a name="troubleshooting-directaccess"></a>Solución de problemas de DirectAccess

>Se aplica a: Windows Server (canal semianual), Windows Server 2016

Siga estos pasos para solucionar problemas de acceso remoto (DirectAccess).

|**Problema**|**Resolución**|
|--|--|
|La consola de administración de acceso remoto no puede mostrar la configuración de DirectAccess|**Para restaurar la información de configuración que falta**<br />-Si va a solucionar problemas de una implementación multisitio, asegúrese de que el controlador de dominio más cercano al punto de entrada está disponible.<br />-Use el cmdlet **Get-DAEntrypointDC** para recuperar el nombre del controlador de dominio más cercano al punto de entrada. Si el controlador de dominio no se está ejecutando, use el cmdlet **set-DAEntryPointDC** para apuntar a otro controlador de dominio.<br />-Ejecute **Gpresult** desde un símbolo del sistema con privilegios elevados en el servidor para asegurarse de que el servidor está obteniendo los objetos de directiva de grupo de DirectAccess.<br />-Habilitar el registro de la interfaz de usuario (IU).<br />-Use el siguiente comando para iniciar el registro de Windows PowerShell:<pre>logman create trace ETWTrace -ow -o c:\ETWTrace.etl -p {AAD4C46D-56DE-4F98-BDA2-B5EAEBDD2B04} 0xffffffffffffffff 0xff -nb 16 16 -bs 1024 -mode 0x2 -max 2048 -ets <br />logman update trace ETWTrace -p {62DFF3DA-7513-4FCA-BC73-25B111FBB1DB} 0xffffffffffffffff 0xff -ets</pre><repro>-Cierre y vuelva a abrir la interfaz de usuario.<br />-Deshabilitar el registro de Windows PowerShell. Recopile los archivos de registro de seguimiento de eventos. Además, recopile todos los registros de la carpeta **% WINDIR%/Tracing**|
|No se puede aplicar la configuración de DirectAccess|**Para actualizar la configuración de DirectAccess**<br />-Si va a solucionar problemas de una implementación multisitio, asegúrese de que el controlador de dominio más cercano al punto de entrada está disponible.<br />-Use el cmdlet **Get-DAEntrypointDC** para recuperar el nombre del controlador de dominio más cercano al punto de entrada. Si el controlador de dominio no se está ejecutando, use el cmdlet **set-DAEntryPointDC** para apuntar a otro controlador de dominio.<br />-Use el siguiente comando para iniciar el registro de Windows PowerShell:<br /><pre>logman create trace ETWTrace -ow -o c:\ETWTrace.etl -p {AAD4C46D-56DE-4F98-BDA2-B5EAEBDD2B04} 0xffffffffffffffff 0xff -nb 16 16 -bs 1024 -mode 0x2 -max 2048 -ets<br />logman update trace ETWTrace -p {62DFF3DA-7513-4FCA-BC73-25B111FBB1DB} 0xffffffffffffffff 0xff -ets</pre>    <repro><br />-Haga clic en **aplicar**.<br />-Después de que se produzca el error, deshabilite el registro de Windows PowerShell y recopile el registro de seguimiento de eventos.|
|DirectAccess está configurado, pero los clientes no pueden conectarse a los recursos internos.|**Para solucionar problemas de conexión de cliente**<br />-Haga clic en la pestaña **Estado de las operaciones** en la consola de administración de acceso remoto y asegúrese de que todos los componentes muestran un icono verde. En caso contrario, compruebe los detalles del error y siga los pasos de resolución.<br />-Ejecute el servidor de acceso remoto Analizador de procedimientos recomendados (BPA). Si hay advertencias o errores, siga los pasos de resolución para resolver el problema.|
|Problemas relacionados con una configuración multisitio (por ejemplo, la habilitación de un multisitio, la adición de puntos de entrada o la configuración del controlador de dominio para un punto de entrada)|Siga los pasos de [solución de problemas de una implementación multisitio](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj554657(v=ws.11)).|
|El icono Estado de configuración del panel muestra una advertencia o un error|Siga los pasos descritos en [supervisión del estado de distribución de la configuración del servidor de acceso remoto](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj574221(v=ws.11)).|
|Problemas relacionados con la configuración del equilibrio de carga (por ejemplo, se produce un error en la configuración al habilitar el equilibrio de carga o hay problemas al agregar o quitar servidores de un clúster)|Si estuviera habilitando el equilibrio de carga o agregando un nodo, y la configuración se actualizó al hacer clic en **aplicar**, pero el clúster no se concedió correctamente en el servidor, ejecute el siguiente comando: **cmd.exe/c "reg Add HKLM\SYSTEM\CurrentControlSet\Services\RaMgmtSvc\Parameters/f/v DebugFlag/t REG_DWORD/d" "0xFFFFFFFF" ""** para recopilar los registros de la interfaz de usuario en el nuevo servidor.|
|Estado de las operaciones muestra un error o una advertencia después de seguir los pasos siguientes para corregir la situación.|Si el estado de las operaciones muestra información incorrecta (como errores, incluso después de corregirlos):<p>-Habilitar la clave del registro **cmd.exe/c "reg Add HKLM\SYSTEM\CurrentControlSet\Services\RaMgmtSvc\Parameters/f/V enabletracing (/t REG_DWORD/d" "5" ""**.<br />-Actualice el estado de las operaciones y recopile los registros de **% WINDIR%/Tracing**.|
|Los equipos cliente de DirectAccess de Windows 8 y versiones posteriores notifican "no Internet" como estado de la conexión de DirectAccess, y el indicador de estado de conectividad de red (NCSI) notifica la conectividad limitada.|Esto puede ocurrir cuando la tunelización forzada está habilitada en la configuración de DirectAccess y, por este motivo, solo se usa IPHTTPS. Para resolver este problema, puede crear y configurar un servidor proxy. NCSI usa el servidor proxy para realizar comprobaciones de conectividad a Internet. Se recomienda agregar un proxy estático a la tabla de directivas de resolución de nombres (NRPT) mediante el procedimiento siguiente.<p>Antes de ejecutar los comandos de este procedimiento, asegúrese de reemplazar todos los nombres de dominio, los nombres de equipo y otras variables de comandos de Windows PowerShell por los valores adecuados para su implementación.<p>**Configurar un proxy estático para una regla de NRPT**<br />1. Mostrar el "." Regla de NRPT: `Get-DnsClientNrptRule -GpoName "corp.example.com\DirectAccess Client Settings" -Server <DomainControllerNetBIOSName>`<br />2. Anote el nombre (GUID) de la "." Regla NRPT. El nombre (GUID) debe comenzar con **da-{..}**<br />3. establezca el proxy para el "." Regla de NRPT para **proxy.Corp.example.com:8080**:  `Set-DnsClientNrptRule -Name "DA-{..}" -Server <DomainControllerNetBIOSName> -GPOName "corp.example.com\DirectAccess Client Settings" -DAProxyServerName "proxy.corp.example.com:8080" -DAProxyType "UseProxyName"`<br />4. Mostrar el "." Vuelva a ejecutar la regla de NRPT ejecutando `Get-DnsClientNrptRule` y compruebe que **ProxyFQDN: Port** está correctamente configurado.<br />5. actualice directiva de grupo ejecutando `gpupdate /force` en un cliente de DirectAccess cuando el cliente está conectado internamente y, a continuación, muestre la tabla NRPT mediante `Get-DnsClientNrptPolicy` y compruebe que la regla "." muestra **ProxyFQDN: Puerto**.|
